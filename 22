var filterIPV4=/^(([1-9][0-9]{0,2})|0)\.(([1-9][0-9]{0,2})|0)\.(([1-9][0-9]{0,2})|0)\.(([1-9][0-9]{0,2})|0)$/;var filterIPV6=/^((([0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}:[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){5}:([0-9A-Fa-f]{1,4}:)?[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){4}:([0-9A-Fa-f]{1,4}:){0,2}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){3}:([0-9A-Fa-f]{1,4}:){0,3}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){2}:([0-9A-Fa-f]{1,4}:){0,4}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b))|(([0-9A-Fa-f]{1,4}:){0,5}:((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b))|(::([0-9A-Fa-f]{1,4}:){0,5}((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b))|([0-9A-Fa-f]{1,4}::([0-9A-Fa-f]{1,4}:){0,5}[0-9A-Fa-f]{1,4})|(::([0-9A-Fa-f]{1,4}:){0,6}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){1,7}:))$/;Vue.component("add-ip",{name:"add-ip",props:["validation","bankid"],mixins:[validationMixin],template:'<section><div id="addIP"><div class="my-3 py-5 container"><input type="hidden" id=ipInitial name="initialIP" value=""><input type="hidden" id="ipFin" name="ipFin" value=""><div class="row justify-content-md-center"><div class="col-lg-5"><h1 style="font-size: 2rem;">Administraci&oacute;n Direcciones IP</h1><h2 style="font-size: 1.5rem;">Adicionar Direcci&#243;n&#40;es&#41; IP</h2><alert  variant="warning" v-show="!inputDisabled">Su segmento requiere IP y no ha sido configurada, realice la asignaci&#243;n a continuaci&#243;n</alert><alert  variant="success" v-show="inputDisabled && !errorIP">&#161;IP(s) asignada(s) exitosamente&#33;<br>IP Inicial {{addIP.initialIP}}<br>IP Final {{addIP.finalIP}}</alert><alert  variant="danger" v-show="errorIP">Detalle:<span style="margin-left: 7px;" v-html="errorMessage"></span></alert><p class="text-helper ui-form-row">Para direcciones de IP &uacute;nicas, solo ingrese informaci&oacute;n en el campo IP Inicial o &Uacute;nica.</p><b-form-group class="mt-1" id="input-group-1" label-for="input-1" label="IP Inicial"><b-form-input id="initialIP" v-model="addIP.initialIP" :disabled="inputDisabled"@focusout="focusInitialIP(false)"@focusin="focusInitialIP(true)"class="size-ip-input":state="stateInitialIP" aria-describedby="input-1-live-feedback" autofocus label-cols-sm="4"> </b-form-input> <b-form-invalid-feedback id="input-1-live-feedback" v-if="validateInputI">Campo requerido</b-form-invalid-feedback><b-form-invalid-feedback id="input-1-live-feedback" v-else-if="initialIPError == errorFormat && addIP.initialIP!=null">Debe ingresar un formato v&aacute;lido</b-form-invalid-feedback></b-form-group> <b-form-group class="mt-1" id="input-group-1" label-for="input-1" label="IP Final"> <b-form-input id="finalIP" v-model="addIP.finalIP" @focusout="focusFinalIP(false)"@focusin="focusFinalIP(true)":disabled="inputDisabled":state="stateFinalIP" class="size-ip-input"aria-describedby="input-1-live-feedback" > </b-form-input> <b-form-invalid-feedback id="input-1-live-feedback" v-if="validateInputF">Campo requerido</b-form-invalid-feedback><b-form-invalid-feedback id="input-1-live-feedback" v-else-if="finalIPError == errorFormat && addIP.finalIP!=null">Debe ingresar un formato v&aacute;lido</b-form-invalid-feedback><b-form-invalid-feedback id="input-1-live-feedback" v-else-if="finalIPError == errorCompareFormat">Debe ingresar IP&#8216;s de la misma versi&oacute;n (IPv4 &oacute; IPv6)</b-form-invalid-feedback><b-form-invalid-feedback id="input-1-live-feedback" v-else-if="finalIPError == errorCompare">La IP Final debe ser mayor a la IP Inicial</b-form-invalid-feedback></b-form-group> <div class="d-flex justify-content-md-center group-btn pt-3"><b-button type="button" @click.prevent="finishIP()" class="button-link" variant="link" size="l" v-show="!inputDisabled">Cancelar</b-button> <b-button type="button" @click.prevent="validateIP()"  variant="success" size="l" v-show="!inputDisabled">Continuar</b-button><b-button type="button" @click.prevent="finishIP()"  variant="success" size="s" v-show="inputDisabled" class="btn-back-ip" style="margin-left: 420px;">Volver</b-button></div></div></div></div></div><v-modal id="result-modal-addIP" title="" variant="success"><p class="text-modal-sucess">&#161;IP(s) asignada(s) exitosamente&#33;</p><div class="d-flex justify-content-center"><b-button type="button" @click="finishAddIP()" variant="success" size="s" class="button-finish-modal">Continuar</b-button></div></v-modal></section>',data:function(){return{errorFormat:"FORMAT",errorCompareFormat:"COMPAREFORMAT",errorCompare:"COMPARE",stateInitialIP:null,stateFinalIP:null,errorMessage:null,initialIPError:null,finalIPError:null,inputDisabled:false,errorIP:false,addIP:{initialIP:"",finalIP:""},}},computed:{validateInputI:function(){if(this.addIP.initialIP==null||this.addIP.initialIP==""){this.initialIPError=null;return true}return false},validateInputF:function(){if(this.addIP.finalIP==null||this.addIP.finalIP==""){this.finalIPError=null;return true}return false}},validations:{addIP:{initialIP:{required:required,validReg:function(){this.initialIPError=null;var a=(filterIPV4.test(this.addIP.initialIP)||filterIPV6.test(this.addIP.initialIP));if(!a){this.initialIPError=this.errorFormat}return a}},finalIP:{validReg:function(){this.finalIPError=null;var a=(filterIPV4.test(this.addIP.finalIP)||filterIPV6.test(this.addIP.finalIP));if(!a){this.finalIPError=this.errorFormat}return a},compareFormatIp:function(){if(this.addIP.finalIP.length>0){var a=null;try{a=this.addIP.finalIP.length==0?false:true}catch(b){a=false}if((this.addIP.finalIP==null||this.addIP.finalIP=="")&&a==true){this.compareFormatCondition(true);return true}if(filterIPV6.test(this.addIP.finalIP)&&filterIPV6.test(this.addIP.initialIP)){this.compareFormatCondition(true);return true}else{if(filterIPV4.test(this.addIP.finalIP)&&filterIPV4.test(this.addIP.initialIP)){this.compareFormatCondition(true);return true}}this.compareFormatCondition(a);return !a}},compareIP:function(){if(this.addIP.finalIP.length>0&&this.addIP.initialIP==this.addIP.finalIP&&this.addIP.initialIP!=""){this.compareCondition(false);return false}var d=this.addIP.initialIP.split(".");var a=this.addIP.finalIP.split(".");var c=true;for(var b=0;b<d.length;b++){if(parseInt(d[b])>parseInt(a[b])){c=false;break}else{if(parseInt(a[b])>parseInt(d[b])){this.compareCondition(true);return true}}}this.compareCondition(c);return c}},}},methods:{focusInitialIP:function(a){if(this.stateInitialIP==false&&this.addIP.initialIP!=null){this.stateInitialIP=null}},focusFinalIP:function(a){if(this.stateFinalIP==false&&this.addIP.finalIP!=null){this.stateFinalIP=null}},compareFormatCondition:function(a){if(a&&this.finalIPError!=this.errorFormat){this.finalIPError=this.errorCompareFormat}},compareCondition:function(a){if(!a&&this.finalIPError!=this.errorFormat){this.finalIPError=this.errorCompare}},finishAddIP:function(){this.$bvModal.hide("result-modal-addIP")},finishIP:function(){footerVue.fixedActive=true;var a=function(){var c="es";var b="";if(this.bankid=="BAVV"){b=("/icbs-web/AjaxTx?AID=NEW_LOGIN_AVV&RQE=FAC0019C79B63595&CRFT=fac0019c79b6348e&language="+c).replace(/MID=[0-9]+/,"MID=")}else{if(this.bankid=="BBTA"){b=("/icbs-web/AjaxTx?AID=NEW_LOGIN_BTA&RQE=FAC0019C79B63597&CRFT=fac0019c79b6348e&language="+c).replace(/MID=[0-9]+/,"MID=")}else{if(this.bankid=="BOCC"){b=("/icbs-web/AjaxTx?AID=NEW_LOGIN_OCC&RQE=FAC0019C79B63598&CRFT=fac0019c79b6348e&language="+c).replace(/MID=[0-9]+/,"MID=")}else{if(this.bankid=="BPOP"){b=("/icbs-web/AjaxTx?AID=NEW_LOGIN_POP&RQE=FAC0019C79B63599&CRFT=fac0019c79b6348e&language="+c).replace(/MID=[0-9]+/,"MID=")}}}}callNextActionPublic("content",b)};killSession("/icbs-web/AjaxTx?AID=PREPARE_EXIT-0000&RQE=FAC0019C79B6359A&CRFT=fac0019c79b6348e",a);return false},validateIP:function(){if(this.addIP.initialIP!=this.addIP.finalIP){$("#ipInitial").val(this.addIP.initialIP);$("#ipFin").val(this.addIP.finalIP)}else{$("#ipInitial").val("");$("#ipFin").val("")}if(this.validateAddIP()){vm.startSpinner();var a=syncAjaxLoad({url:"/icbs-web/AjaxTx?AID=CONFIRM_TRANSACTION_PUBLIC-0100&RQE=FAC0019C79B6359B&CRFT=fac0019c79b6348e",params:{ServicePublic:"LOGIN_ADMIN_IP_SAVING-0100",initialIP:this.addIP.initialIP,ipFin:this.addIP.finalIP}});this.inputDisabled=true;$(".size-ip-input").css("max-width","442px");if(a[0]=="000000"){this.$bvModal.show("result-modal-addIP");vm.finishSpinner()}else{this.errorIP=true;var b=a[0].messageError;if(b.indexOf("|")!==-1){b=b.split("|")[0]}this.errorMessage="("+a[0].statusCode+") "+b;vm.finishSpinner()}}},validateState:function(b,a){$error=a;$dirty=b;return $dirty?!$error:null},validateAddIP:function(){this.$v.addIP.$touch();this.stateInitialIP=this.validateState(this.$v.addIP.initialIP.$dirty,this.$v.addIP.initialIP.$error);if(this.addIP.finalIP.length>0){this.stateFinalIP=this.validateState(this.$v.addIP.finalIP.$dirty,this.$v.addIP.finalIP.$error)}else{this.stateFinalIP=true}if(!this.stateInitialIP&&!this.stateFinalIP){return false}else{if(this.stateInitialIP&&this.stateFinalIP){return true}}}}});